@model IEnumerable<FoodSathi.Models.Order>

@{
    ViewData["Title"] = "My Orders";
}

<div class="container py-5">
    <!-- Page Header -->
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-start mb-5">
        <div>
            <h1 class="fw-bold text-gradient mb-2">📦 @ViewData["Title"]</h1>
            <p class="text-muted">All your recent orders, neatly organized and easy to track.</p>
        </div>
    </div>

    @if (Model == null || !Model.Any())
    {
        <div class="alert alert-info shadow-sm text-center">
            <i class="bi bi-info-circle fs-3 me-2"></i>No orders found.
            <a href="/" class="fw-semibold text-decoration-none">Browse Menu</a>
        </div>
    }
    else
    {
        <div class="row g-4">
            @foreach (var order in Model)
            {
                <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-3">
                    <div class="card shadow-sm border-0 rounded-4 overflow-hidden h-100">
                        <div class="card-body d-flex flex-column">

                            <!-- Order Header -->
                            <div class="d-flex justify-content-between align-items-start mb-2 flex-wrap">
                                <span class="badge bg-primary rounded-pill mb-1">#@order.OrderID</span>
                                <span class="text-muted small mb-1">@order.OrderDate.ToString("MMM dd, yyyy")</span>
                            </div>

                            <!-- 🛒 Order Type -->
                            @if (order.FromCart)
                            {
                                <span class="badge bg-dark mb-3" data-bs-toggle="tooltip" data-bs-placement="top"
                                      title="This order was placed from your shopping cart.">
                                    🛒 From Cart
                                </span>
                            }
                            else
                            {
                                <span class="badge bg-secondary mb-3" data-bs-toggle="tooltip" data-bs-placement="top"
                                      title="This order was placed directly using Buy Now.">
                                    ⚡ Single Item
                                </span>
                            }

                            <!-- Item Info -->
                            <h5 class="card-title fw-bold">@order.ItemName</h5>
                            <p class="card-text mb-1">Quantity: <strong>@order.Quantity</strong></p>
                            <p class="card-text mb-2">Total: <span class="fw-bold text-success">Rs. @order.TotalPrice</span></p>
                            <p class="card-text mb-2">Total Amount: <span class="fw-bold text-success">Rs. @order.TotalAmount</span></p>

                            <!-- Payment Info with Tooltips -->
                            <p class="card-text mb-3">
                                Payment Method:
                                <strong>
                                    @switch (order.PaymentMethod)
                                    {
                                        case "eSewa":
                                            <span class="badge bg-success" data-bs-toggle="tooltip" data-bs-placement="top"
                                                  title="Paid via eSewa on @order.OrderDate.ToString("dd MMM yyyy")">💚 eSewa</span>
                                            break;
                                        case "Khalti":
                                            <span class="badge bg-success" data-bs-toggle="tooltip" data-bs-placement="top"
                                                  title="Paid via Khalti on @order.OrderDate.ToString("dd MMM yyyy")">💜 Khalti</span>
                                            break;
                                        case "IME Pay":
                                            <span class="badge bg-success" data-bs-toggle="tooltip" data-bs-placement="top"
                                                  title="Paid via IME Pay on @order.OrderDate.ToString("dd MMM yyyy")">🧡 IME Pay</span>
                                            break;
                                        case "Card":
                                            <span class="badge bg-success" data-bs-toggle="tooltip" data-bs-placement="top"
                                                  title="Paid via Card on @order.OrderDate.ToString("dd MMM yyyy")">💳 Card</span>
                                            break;
                                        case "Cash On Delivery":
                                            if (order.PaymentStatus == "Paid")
                                            {
                                                <span class="badge bg-success" data-bs-toggle="tooltip" data-bs-placement="top"
                                                      title="Paid via Cash on Delivery on @order.OrderDate.ToString("dd MMM yyyy")">💵 COD Paid</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-warning" data-bs-toggle="tooltip" data-bs-placement="top"
                                                      title="Cash on delivery, not yet paid">💵 COD Pending</span>
                                            }
                                            break;
                                        default:
                                            <span class="badge bg-secondary">@order.PaymentMethod</span>
                                            break;
                                    }
                                </strong>
                            </p>

                            <!-- Delivery Option with Tooltips -->
                            <p class="card-text mb-3">
                                Delivery Option:
                                @switch (order.DeliveryOption)
                                {
                                    case "Standard":
                                        <span class="badge bg-info" data-bs-toggle="tooltip" data-bs-placement="top"
                                              title="Standard delivery will arrive in 3–5 days">Standard 🚚</span>
                                        break;
                                    case "Express":
                                        <span class="badge bg-danger" data-bs-toggle="tooltip" data-bs-placement="top"
                                              title="Express delivery will arrive in 1–2 hours">Express ⚡</span>
                                        break;
                                    case "Pickup":
                                        <span class="badge bg-secondary" data-bs-toggle="tooltip" data-bs-placement="top"
                                              title="Pickup your order at our store">Pickup 🛍</span>
                                        break;
                                    default:
                                        <span class="badge bg-light text-dark">N/A</span>
                                        break;
                                }
                            </p>

                            <div class="mt-auto">
                                <a href="@Url.Action("Track", "Order", new { id = order.OrderID })"
                                   class="btn btn-outline-primary w-100 rounded-pill fw-semibold">
                                    🚀 Track Order
                                </a>
                            </div>

                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

<!-- Enable Bootstrap tooltips -->
@section Scripts {
    <script>
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })
    </script>
}

<style>
    .text-gradient {
        background: linear-gradient(135deg, #6610f2, #0d6efd);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .card {
        transition: all 0.3s ease-in-out;
    }

        .card:hover {
            transform: translateY(-6px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

    .badge {
        font-size: 0.85rem;
        padding: 0.45em 0.9em;
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
    }

        .badge:hover {
            transform: scale(1.1);
        }

    h5.card-title {
        font-size: 1.1rem;
        margin-bottom: 0.3rem;
    }

    .card-text {
        font-size: 0.95rem;
        color: #555;
    }

    @@media (max-width: 576px) {
        .card-title {
            font-size: 1rem;
        }

        .card-text {
            font-size: 0.9rem;
        }
    }
</style>
